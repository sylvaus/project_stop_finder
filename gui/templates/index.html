{% extends 'base.html' %}

{% block head %}
<title>Stop Finder</title>
{% endblock %}

{% block body %}
<div class="content">
    <h1>Stop Finder</h1>
    <img src="./../static/bmb.png"></img>
    <br><br><br>
    <div class="form">
        <form action="/" method="POST">
            <table>
                <tr>
                    <td><label>Enter Stop Name</label></td>
                    <td><input type="text" name="stop" id="stop">
                        <input type="checkbox" name="rgx" id="rgx" value="True" style="margin-left: -.5vw;">
                        <label for="rgx" style="margin-left: -.75vw; color: wheat;">regex</label>

                    </td>
                </tr>
                <tr>
                    <td><label>Enter Range </label></td>
                    <td><input type="text" name="range" id="range"></td>
                </tr>
                <tr>
                    <td><label>Enter Current Location </label></td>
                    <td><input type="text" name="current_location" id="current_location"></td>
                </tr>
            </table>
            <br>
            <div>
                <input type="submit" name="Find" value="Find">
                <input type="submit" name="Show All" value="Show All">
            </div>
        </form>

        <br><br>

        <div id="map" style="height: 20vw; width: 50vw; float: left; border: solid;"></div>
        <script type="text/javascript">
            // The first parameter are the coordinates of the center of the map
            // The second parameter is the zoom level
            var map = L.map('map').setView([45.50761009451047, -73.55183601379395], 12);
            
            // {s}, {z}, {x} and {y} are placeholders for map tiles
            // {x} and {y} are the x/y of where you are on the map
            // {z} is the zoom level
            // {s} is the subdomain of cartodb
              var layer = L.tileLayer('http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {
              attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'
            });
            
            // Now add the layer onto the map
            map.addLayer(layer);
          </script>

        <br><br>

        {% if lstName %} {% autoescape false %}
        <table class="table">
            <tr style="text-align: center;">
                <th>Stop name</th>
                <th>Distance To Reach</th>
            </tr>
            <tr>
                <td style="border-right:solid rgb(31, 29, 29);">
                    {% for ins in lstName %}
                    <li>{{ins}}</li>
                    {% endfor %}
                </td>
                <td>
                    {% for ins in lstDistance %}
                    <li>{{ins}}</li>
                    {% endfor %}
                </td>
            </tr>
        </table>
        {% endautoescape %} {% endif %}

        {% if stopName %} {% autoescape false %}
        <table class="table">
            <tr style="text-align: center;">
                <th>Stop name</th><th>Distance To Reach</th>
            </tr>
            <tr>
                <td>{{stopName}}</td><td>{{stopDistance}}</td>
            </tr>
        </table>
        {% endautoescape %} {% endif %}

        {% if result %} {% autoescape false %}
        <table class="table" style="display: inline-flex;">
            <tr style="text-align: center;">
                <th>Stop name</th>
            </tr>
            <tr>
                <td>{{ result }}</td>
            </tr>
        </table>
        {% endautoescape %} {% endif %}

    </div>
</div>
{% endblock %}